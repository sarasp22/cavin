<nav class="navbar">
  <div class="navbar-container">
    <div class="navbar-brand">
      <%= link_to root_path, class: "logo-link" do %>
        <div class="logo-icon">
         <%= image_tag "logo.png", alt: "logo Cavin", width: 40, height: 40 %>
        </div>
      <% end %>
    </div>

    <div class="navbar-actions">
      <% if user_signed_in? %>
        <div class="nav-dropdown">
          <button class="dropdown-toggle-profile">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            Profil
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="chevron">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
          <div class="dropdown-menu">
            <%= link_to storages_path, class: "dropdown-item" do %>
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
              </svg>
              Mes Caves
            <% end %>
            <%= link_to history_path, class: "dropdown-item" do %>
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
              Historique
            <% end %>

                <%= link_to wine_templates_path, class: "dropdown-item" do %>
                 <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                 <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                 <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                </svg>
                Ma Bibliothèque
             <% end %>
            <div class="dropdown-divider"></div>
            <%= link_to destroy_user_session_path, data: { turbo_method: :delete }, class: "dropdown-item logout" do %>
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
              </svg>
              Déconnexion
            <% end %>
          </div>
        </div>
      <% else %>
        <%= link_to "Connexion", new_user_session_path, class: "btn-navbar btn-login" %>
      <% end %>
    </div>

    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>

  <div class="mobile-menu" id="mobile-menu">
    <% if user_signed_in? %>
      <div class="mobile-divider">Mon Compte</div>
      <%= link_to storages_path, class: "mobile-nav-link" do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
        </svg>
        Mes Caves
      <% end %>
      <%= link_to history_path, class: "mobile-nav-link" do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        Historique
      <% end %>

                <%= link_to wine_templates_path, class: "mobile-nav-link" do %>
                 <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                 <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                 <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                </svg>
                Ma Bibliothèque
             <% end %>
      <%= link_to destroy_user_session_path, data: { turbo_method: :delete }, class: "mobile-nav-link logout" do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 17 21 12 16 7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
        Déconnexion
      <% end %>
    <% else %>
      <%= link_to "Connexion", new_user_session_path, class: "mobile-nav-link btn-mobile-login" %>
    <% end %>
  </div>
</nav>

<script>
  function toggleMobileMenu() {
    const mobileMenu = document.getElementById('mobile-menu');
    const toggleButton = document.querySelector('.mobile-menu-toggle');

    mobileMenu.classList.toggle('active');
    toggleButton.classList.toggle('active');
  }
</script>
