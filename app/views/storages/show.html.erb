<div class="storage-show-container">
  <div class="storage-show-header">
    <div>
      <h1 class="storage-show-title"><%= @storage.name %></h1>
      <p class="storage-show-subtitle">
        <%= @storage.category %> â€¢ <%= @wines.count %> bouteilles
      </p>
    </div>
    <div class="storage-show-actions">
      <%= link_to storages_path, class: "btn-back" do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="m12 19-7-7 7-7"></path>
          <path d="M19 12H5"></path>
        </svg>
        Retour
      <% end %>
      <%= link_to edit_storage_path(@storage), class: "btn-edit" do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"></path>
        </svg>
        Modifier
      <% end %>
    </div>
  </div>

  <div class="wine-grid-container">
    <div class="wine-grid" style="grid-template-columns: repeat(<%= @storage.cols %>, 1fr);">
      <% (@storage.rows * @storage.cols).times do |index| %>
        <% row = (index / @storage.cols) + 1 %>
        <% col = (index % @storage.cols) + 1 %>
        <% wine = @wines.find { |w| w.row_position == row && w.col_position == col } %>

        <% if wine %>
          <%= link_to storage_wine_path(@storage, wine), class: "wine-slot filled" do %>
            <div class="wine-bottle-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8 2h8l2 10-4 10-4-10z"/>
                <ellipse cx="12" cy="2" rx="4" ry="1"/>
              </svg>
            </div>
            <div class="wine-info">
              <p class="wine-name"><%= wine.name %></p>
              <p class="wine-type"><%= wine.wine_type %></p>
            </div>
          <% end %>
        <% else %>
          <%= link_to new_storage_wine_path(@storage, row: row, col: col), class: "wine-slot empty" do %>
            <div class="add-wine-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
            </div>
            <p class="slot-position">R<%= row %> C<%= col %></p>
          <% end %>
        <% end %>
      <% end %>
    </div>
  </div>

  <%= link_to new_storage_wine_path(@storage), class: "floating-add-btn", title: "Ajouter un vin" do %>
    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
      <line x1="12" y1="5" x2="12" y2="19"></line>
      <line x1="5" y1="12" x2="19" y2="12"></line>
    </svg>
  <% end %>
</div>
